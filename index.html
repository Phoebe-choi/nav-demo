<!DOCTYPE html>
<html lang="zh-Hans">
<head>
	<meta charset="utf-8">
	<title>我的导航页面</title>
	<link rel="stylesheet" type="text/css" href="./style.css">
</head>
<body>
	<header></header>
	<main>
			<style>
			</style>
		<div class="wrapper" id="main">
			
		</div>
	</main>
	<footer></footer>
	<script>
		//1.初始化数据
		var keys={
			'0':{0:'q',1:'w',2:'e',3:'r',4:'t',5:'y',6:'u',7:'i',8:'o',9:'p',length:10},
			'1':{0:'a',1:'s',2:'d',3:'f',4:'g',5:'h',6:'j',7:'k',8:'l',length:9},
			'2':{0:'z',1:'x',2:'c',3:'v',4:'b',5:'n',6:'m',length:7},
			'length':3
		}
		var hash={
			'w':'weibo.com',
			'i':'iqiyi.com',
			'o':'opera.com',
			'j':'www.jianshu.com',
			'z':'zhihu.com',
		}
		//取出localStorage中的zzz对应的hash
		var hashInLocalStorage=getFromLocalStorage('zzz')
		if(hashInLocalStorage){
				hash=hashInLocalStorage
		}

		function createSpan(textContent){
			var span=tag('span')
			span.textContent=textContent
			span.className="text"
			return span
		}	
		function createButton(id){
			var button=tag('button')
				button.textContent='编辑'
				button.id=id
				button.onclick=function(xzkjcnxlkcjlk){
					var button2=xzkjcnxlkcjlk['target']
					var img2=button2.previousSibling
					var key=button2['id']
					var x=prompt('给我一个网址')
					hash[key]=x 
					img2.src='http://'+x+'/favicon.ico'
					img2.onerror=function(xxx){
							xxx.target.src=''
					}
					localStorage.setItem('zzz',JSON.stringify(hash))	
				}
				return button
		}
		function createImage(domain){
			var image=tag('img')
					// image.src='http://'+hash[row[index2]]+'/favicon.ico'
					if(domain){
							image.src='http://'+domain+'/favicon.ico'
					}else{
							image.src=''
					}
					image.onerror=function(xxx){
							xxx.target.src=''
					}
					return image
		}
		//2.生成键盘
		for(var index=0;index<keys['length'];index=index+1){
				var div1=tag('div') 
				div1.className='row'

				main.appendChild(div1)

				var row=keys[index] 
				// console.log(row) 
				for(var index2=0;index2<row['length'];index2=index2+1){
						var span=createSpan(row[index2])

						var button=createButton(row[index2])

						var image=createImage(hash[row[index2]])
						
						var keybd=tag('kbd')
						keybd.className='key'

						keybd.appendChild(span)
						keybd.appendChild(image)
						keybd.appendChild(button)
						
						div1.appendChild(keybd)
					}
		}
		//3.监听用户
		document.onkeypress=function(xzkjcnxlkcjlk){
			var key=xzkjcnxlkcjlk['key'] 
			var website=hash[key]
			console.log(website)
			window.open('http://'+website,'_blank')
		}



		function getFromLocalStorage(name){
			return JSON.parse(localStorage.getItem(name)||'null')
		}
		function tag(tagName){
		return document.createElement(tagName)
		}
	
	</script>
</body>
</html>